from typing import Union

ALL = 'all'

rates = {
    "California": {
        "BI-1": "$571.23",
        "II-1": "$802.72",
        "AI-1": "$1,031.71",
        "AI80-1": "$991.71",
        "BI-2": "$685.47",
        "II-2": "$917.39",
        "AI-2": "$1,146.35",
        "AI80-2": "$1,101.90",
        "BI-3": "$799.72",
        "II-3": "$1,032.07",
        "AI-3": "$1,260.98",
        "AI80-3": "$1,212.09"
    },
    "Florida": {
        "BI-1": "$364.69",
        "II-1": "$513.57",
        "AI-1": "$659.94",
        "AI80-1": "$619.94",
        "BI-2": "$437.63",
        "II-2": "$586.93",
        "AI-2": "$733.27",
        "AI80-2": "$688.82",
        "BI-3": "$510.57",
        "II-3": "$660.30",
        "AI-3": "$806.60",
        "AI80-3": "$757.71"
    },
    "Texas": {
        "BI-1": "$395.48",
        "II-1": "$556.67",
        "AI-1": "$715.36",
        "AI80-1": "$675.36",
        "BI-2": "$474.57",
        "II-2": "$636.19",
        "AI-2": "$794.85",
        "AI80-2": "$750.40",
        "BI-3": "$553.67",
        "II-3": "$715.72",
        "AI-3": "$874.33",
        "AI80-3": "$825.44"
    },
    "Washington": {
        "BI-1": "$595.60",
        "II-1": "$836.84",
        "AI-1": "$1,075.58",
        "AI80-1": "$1,035.58",
        "BI-2": "$714.72",
        "II-2": "$956.39",
        "AI-2": "$1,195.09",
        "AI80-2": "$1,150.65",
        "BI-3": "$833.84",
        "II-3": "$1,075.94",
        "AI-3": "$1,314.60",
        "AI80-3": "$1,265.71"
    },
    "New York": {
        "BI-1": "$616.13",
        "II-1": "$865.58",
        "AI-1": "$1,112.53",
        "AI80-1": "$1,072.53",
        "BI-2": "$739.35",
        "II-2": "$989.23",
        "AI-2": "$1,236.15",
        "AI80-2": "$1,191.70",
        "BI-3": "$862.58",
        "II-3": "$1,112.89",
        "AI-3": "$1,359.76",
        "AI80-3": "$1,310.87"
    },
    "New Jersey": {
        "BI-1": "$602.50",
        "II-1": "$846.50",
        "AI-1": "$1,088.00",
        "AI80-1": "$1,048.00",
        "BI-2": "$723.00",
        "II-2": "$967.43",
        "AI-2": "$1,208.88",
        "AI80-2": "$1,164.44",
        "BI-3": "$843.50",
        "II-3": "$1,088.35",
        "AI-3": "$1,329.77",
        "AI80-3": "$1,280.88"
    },
    "Arizona": {
        "BI-1": "$381.69",
        "II-1": "$537.36",
        "AI-1": "$690.54",
        "AI80-1": "$650.54",
        "BI-2": "$458.03",
        "II-2": "$614.13",
        "AI-2": "$767.26",
        "AI80-2": "$722.82",
        "BI-3": "$534.36",
        "II-3": "$690.90",
        "AI-3": "$843.99",
        "AI80-3": "$795.10"
    },
    "Illinois": {
        "BI-1": "$627.19",
        "II-1": "$881.07",
        "AI-1": "$1,132.45",
        "AI80-1": "$1,092.45",
        "BI-2": "$752.63",
        "II-2": "$1,006.94",
        "AI-2": "$1,258.27",
        "AI80-2": "$1,213.83",
        "BI-3": "$878.07",
        "II-3": "$1,132.80",
        "AI-3": "$1,384.10",
        "AI80-3": "$1,335.21"
    },
    "Colorado": {
        "BI-1": "$436.85",
        "II-1": "$614.59",
        "AI-1": "$789.83",
        "AI80-1": "$749.83",
        "BI-2": "$524.22",
        "II-2": "$702.39",
        "AI-2": "$877.59",
        "AI80-2": "$833.14",
        "BI-3": "$611.59",
        "II-3": "$790.19",
        "AI-3": "$965.35",
        "AI80-3": "$916.46"
    },
    "Georgia": {
        "BI-1": "$408.63",
        "II-1": "$575.08",
        "AI-1": "$739.03",
        "AI80-1": "$699.03",
        "BI-2": "$490.35",
        "II-2": "$657.23",
        "AI-2": "$821.14",
        "AI80-2": "$776.70",
        "BI-3": "$572.08",
        "II-3": "$739.39",
        "AI-3": "$903.26",
        "AI80-3": "$854.37"
    },
    "Oregon": {
        "BI-1": "$612.28",
        "II-1": "$860.19",
        "AI-1": "$1,105.60",
        "AI80-1": "$1,065.60",
        "BI-2": "$734.74",
        "II-2": "$983.08",
        "AI-2": "$1,228.45",
        "AI80-2": "$1,184.00",
        "BI-3": "$857.19",
        "II-3": "$1,105.96",
        "AI-3": "$1,351.29",
        "AI80-3": "$1,302.40"
    },
    "Massachusetts": {
        "BI-1": "$571.07",
        "II-1": "$802.50",
        "AI-1": "$1,031.42",
        "AI80-1": "$991.42",
        "BI-2": "$685.28",
        "II-2": "$917.14",
        "AI-2": "$1,146.03",
        "AI80-2": "$1,101.58",
        "BI-3": "$799.50",
        "II-3": "$1,031.78",
        "AI-3": "$1,260.63",
        "AI80-3": "$1,211.74"
    },
    "Virginia": {
        "BI-1": "$437.65",
        "II-1": "$615.71",
        "AI-1": "$791.27",
        "AI80-1": "$751.27",
        "BI-2": "$525.18",
        "II-2": "$703.67",
        "AI-2": "$879.19",
        "AI80-2": "$834.75",
        "BI-3": "$612.71",
        "II-3": "$791.63",
        "AI-3": "$967.11",
        "AI80-3": "$918.22"
    },
    "Maryland": {
        "BI-1": "$469.08",
        "II-1": "$659.71",
        "AI-1": "$847.85",
        "AI80-1": "$807.85",
        "BI-2": "$562.90",
        "II-2": "$753.96",
        "AI-2": "$942.05",
        "AI80-2": "$897.61",
        "BI-3": "$656.71",
        "II-3": "$848.20",
        "AI-3": "$1,036.26",
        "AI80-3": "$987.37"
    },
    "Pennsylvania": {
        "BI-1": "$515.59",
        "II-1": "$724.82",
        "AI-1": "$931.55",
        "AI80-1": "$891.55",
        "BI-2": "$618.70",
        "II-2": "$828.36",
        "AI-2": "$1,035.06",
        "AI80-2": "$990.61",
        "BI-3": "$721.82",
        "II-3": "$931.91",
        "AI-3": "$1,138.56",
        "AI80-3": "$1,089.68"
    },
    "North Carolina": {
        "BI-1": "$354.59",
        "II-1": "$499.42",
        "AI-1": "$641.76",
        "AI80-1": "$601.76",
        "BI-2": "$425.51",
        "II-2": "$570.77",
        "AI-2": "$713.06",
        "AI80-2": "$668.62",
        "BI-3": "$496.42",
        "II-3": "$642.11",
        "AI-3": "$784.37",
        "AI80-3": "$735.48"
    },
    "Ohio": {
        "BI-1": "$434.28",
        "II-1": "$611.00",
        "AI-1": "$785.21",
        "AI80-1": "$745.21",
        "BI-2": "$521.14",
        "II-2": "$698.28",
        "AI-2": "$872.46",
        "AI80-2": "$828.01",
        "BI-3": "$608.00",
        "II-3": "$785.57",
        "AI-3": "$959.70",
        "AI80-3": "$910.81"
    },
    "Utah": {
        "BI-1": "$427.23",
        "II-1": "$601.12",
        "AI-1": "$772.51",
        "AI80-1": "$732.51",
        "BI-2": "$512.67",
        "II-2": "$686.99",
        "AI-2": "$858.35",
        "AI80-2": "$813.90",
        "BI-3": "$598.12",
        "II-3": "$772.87",
        "AI-3": "$944.18",
        "AI80-3": "$895.29"
    },
    "Nevada": {
        "BI-1": "$500.67",
        "II-1": "$703.94",
        "AI-1": "$904.71",
        "AI80-1": "$864.71",
        "BI-2": "$600.81",
        "II-2": "$804.50",
        "AI-2": "$1,005.23",
        "AI80-2": "$960.79",
        "BI-3": "$700.94",
        "II-3": "$905.07",
        "AI-3": "$1,105.76",
        "AI80-3": "$1,056.87"
    },
    "Hawaii": {
        "BI-1": "$597.53",
        "II-1": "$839.54",
        "AI-1": "$1,079.05",
        "AI80-1": "$1,039.05",
        "BI-2": "$717.03",
        "II-2": "$959.47",
        "AI-2": "$1,198.94",
        "AI80-2": "$1,154.50",
        "BI-3": "$836.54",
        "II-3": "$1,079.41",
        "AI-3": "$1,318.84",
        "AI80-3": "$1,269.95"
    },
    "Michigan": {
        "BI-1": "$470.52",
        "II-1": "$661.73",
        "AI-1": "$850.44",
        "AI80-1": "$810.44",
        "BI-2": "$564.63",
        "II-2": "$756.27",
        "AI-2": "$944.94",
        "AI80-2": "$900.49",
        "BI-3": "$658.73",
        "II-3": "$850.80",
        "AI-3": "$1,039.43",
        "AI80-3": "$990.54"
    },
    "Minnesota": {
        "BI-1": "$517.99",
        "II-1": "$728.19",
        "AI-1": "$935.88",
        "AI80-1": "$895.88",
        "BI-2": "$621.59",
        "II-2": "$832.21",
        "AI-2": "$1,039.87",
        "AI80-2": "$995.43",
        "BI-3": "$725.19",
        "II-3": "$936.24",
        "AI-3": "$1,143.86",
        "AI80-3": "$1,094.97"
    },
    "Connecticut": {
        "BI-1": "$511.10",
        "II-1": "$718.53",
        "AI-1": "$923.47",
        "AI80-1": "$883.47",
        "BI-2": "$613.31",
        "II-2": "$821.18",
        "AI-2": "$1,026.08",
        "AI80-2": "$981.63",
        "BI-3": "$715.53",
        "II-3": "$923.83",
        "AI-3": "$1,128.69",
        "AI80-3": "$1,079.80"
    },
    "Tennessee": {
        "BI-1": "$388.74",
        "II-1": "$547.24",
        "AI-1": "$703.24",
        "AI80-1": "$663.24",
        "BI-2": "$466.49",
        "II-2": "$625.42",
        "AI-2": "$781.38",
        "AI80-2": "$736.93",
        "BI-3": "$544.24",
        "II-3": "$703.60",
        "AI-3": "$859.51",
        "AI80-3": "$810.62"
    },
    "Missouri": {
        "BI-1": "$461.22",
        "II-1": "$648.71",
        "AI-1": "$833.70",
        "AI80-1": "$793.70",
        "BI-2": "$553.47",
        "II-2": "$741.39",
        "AI-2": "$926.34",
        "AI80-2": "$881.89",
        "BI-3": "$645.71",
        "II-3": "$834.06",
        "AI-3": "$1,018.97",
        "AI80-3": "$970.08"
    },
    "Wisconsin": {
        "BI-1": "$485.92",
        "II-1": "$683.29",
        "AI-1": "$878.15",
        "AI80-1": "$838.15",
        "BI-2": "$583.10",
        "II-2": "$780.90",
        "AI-2": "$975.73",
        "AI80-2": "$931.28",
        "BI-3": "$680.29",
        "II-3": "$878.51",
        "AI-3": "$1,073.30",
        "AI80-3": "$1,024.41"
    },
    "South Carolina": {
        "BI-1": "$364.21",
        "II-1": "$512.89",
        "AI-1": "$659.08",
        "AI80-1": "$619.08",
        "BI-2": "$437.05",
        "II-2": "$586.16",
        "AI-2": "$732.31",
        "AI80-2": "$687.86",
        "BI-3": "$509.89",
        "II-3": "$659.43",
        "AI-3": "$805.54",
        "AI80-3": "$756.65"
    },
    "Oklahoma": {
        "BI-1": "$417.93",
        "II-1": "$588.10",
        "AI-1": "$755.77",
        "AI80-1": "$715.77",
        "BI-2": "$501.51",
        "II-2": "$672.11",
        "AI-2": "$839.75",
        "AI80-2": "$795.30",
        "BI-3": "$585.10",
        "II-3": "$756.13",
        "AI-3": "$923.72",
        "AI80-3": "$874.83"
    },
    "Kansas": {
        "BI-1": "$424.18",
        "II-1": "$596.85",
        "AI-1": "$767.03",
        "AI80-1": "$727.03",
        "BI-2": "$509.02",
        "II-2": "$682.12",
        "AI-2": "$852.25",
        "AI80-2": "$807.81",
        "BI-3": "$593.85",
        "II-3": "$767.38",
        "AI-3": "$937.48",
        "AI80-3": "$888.59"
    },
    "Alabama": {
        "BI-1": "$359.24",
        "II-1": "$505.93",
        "AI-1": "$650.13",
        "AI80-1": "$610.13",
        "BI-2": "$431.09",
        "II-2": "$578.21",
        "AI-2": "$722.36",
        "AI80-2": "$677.92",
        "BI-3": "$502.93",
        "II-3": "$650.49",
        "AI-3": "$794.60",
        "AI80-3": "$745.71"
    },
    "New Hampshire": {
        "BI-1": "$440.22",
        "II-1": "$619.30",
        "AI-1": "$795.89",
        "AI80-1": "$755.89",
        "BI-2": "$528.26",
        "II-2": "$707.78",
        "AI-2": "$884.32",
        "AI80-2": "$839.88",
        "BI-3": "$616.30",
        "II-3": "$796.25",
        "AI-3": "$972.76",
        "AI80-3": "$923.87"
    },
    "Kentucky": {
        "BI-1": "$397.72",
        "II-1": "$559.81",
        "AI-1": "$719.40",
        "AI80-1": "$679.40",
        "BI-2": "$477.27",
        "II-2": "$639.79",
        "AI-2": "$799.34",
        "AI80-2": "$754.89",
        "BI-3": "$556.81",
        "II-3": "$719.76",
        "AI-3": "$879.27",
        "AI80-3": "$830.38"
    },
    "New Mexico": {
        "BI-1": "$407.67",
        "II-1": "$573.73",
        "AI-1": "$737.30",
        "AI80-1": "$697.30",
        "BI-2": "$489.20",
        "II-2": "$655.69",
        "AI-2": "$819.22",
        "AI80-2": "$774.78",
        "BI-3": "$570.73",
        "II-3": "$737.65",
        "AI-3": "$901.14",
        "AI80-3": "$852.25"
    },
    "District of Columbia": {
        "State": "District of Columbia",
        "BI-1": "$589.35",
        "II-1": "$828.09",
        "AI-1": "$1,064.33",
        "AI80-1": "$1,024.33",
        "BI-2": "$707.22",
        "II-2": "$946.39",
        "AI-2": "$1,182.59",
        "AI80-2": "$1,138.14",
        "BI-3": "$825.09",
        "II-3": "$1,064.68",
        "AI-3": "$1,300.85",
        "AI80-3": "$1,251.96"
    },
    "Idaho": {
        "BI-1": "$388.58",
        "II-1": "$547.02",
        "AI-1": "$702.95",
        "AI80-1": "$662.95",
        "BI-2": "$466.30",
        "II-2": "$625.16",
        "AI-2": "$781.06",
        "AI80-2": "$736.61",
        "BI-3": "$544.02",
        "II-3": "$703.31",
        "AI-3": "$859.16",
        "AI80-3": "$810.27"
    },
    "Iowa": {
        "BI-1": "$423.70",
        "II-1": "$596.18",
        "AI-1": "$766.16",
        "AI80-1": "$726.16",
        "BI-2": "$508.44",
        "II-2": "$681.35",
        "AI-2": "$851.29",
        "AI80-2": "$806.85",
        "BI-3": "$593.18",
        "II-3": "$766.52",
        "AI-3": "$936.42",
        "AI80-3": "$887.53"
    },
    "Vermont": {
        "BI-1": "$388.74",
        "II-1": "$547.24",
        "AI-1": "$703.24",
        "AI80-1": "$663.24",
        "BI-2": "$466.49",
        "II-2": "$625.42",
        "AI-2": "$781.38",
        "AI80-2": "$736.93",
        "BI-3": "$544.24",
        "II-3": "$703.60",
        "AI-3": "$859.51",
        "AI80-3": "$810.62"
    },
    "Delaware": {
        "BI-1": "$413.28",
        "II-1": "$581.59",
        "AI-1": "$747.40",
        "AI80-1": "$707.40",
        "BI-2": "$495.93",
        "II-2": "$664.67",
        "AI-2": "$830.44",
        "AI80-2": "$786.00",
        "BI-3": "$578.59",
        "II-3": "$747.76",
        "AI-3": "$913.49",
        "AI80-3": "$864.60"
    },
    "Louisiana": {
        "BI-1": "$413.12",
        "II-1": "$581.36",
        "AI-1": "$747.11",
        "AI80-1": "$707.11",
        "BI-2": "$495.74",
        "II-2": "$664.42",
        "AI-2": "$830.12",
        "AI80-2": "$785.68",
        "BI-3": "$578.36",
        "II-3": "$747.47",
        "AI-3": "$913.14",
        "AI80-3": "$864.25"
    },
    "Maine": {
        "BI-1": "$434.28",
        "II-1": "$611.00",
        "AI-1": "$785.21",
        "AI80-1": "$745.21",
        "BI-2": "$521.14",
        "II-2": "$698.28",
        "AI-2": "$872.46",
        "AI80-2": "$828.01",
        "BI-3": "$608.00",
        "II-3": "$785.57",
        "AI-3": "$959.70",
        "AI80-3": "$910.81"
    },
    "Nebraska": {
        "BI-1": "$388.10",
        "II-1": "$546.34",
        "AI-1": "$702.08",
        "AI80-1": "$662.08",
        "BI-2": "$465.72",
        "II-2": "$624.39",
        "AI-2": "$780.09",
        "AI80-2": "$735.65",
        "BI-3": "$543.34",
        "II-3": "$702.44",
        "AI-3": "$858.10",
        "AI80-3": "$809.21"
    },
    "Rhode Island": {
        "BI-1": "$448.40",
        "II-1": "$630.75",
        "AI-1": "$810.61",
        "AI80-1": "$770.61",
        "BI-2": "$538.08",
        "II-2": "$720.86",
        "AI-2": "$900.68",
        "AI80-2": "$856.24",
        "BI-3": "$627.75",
        "II-3": "$810.97",
        "AI-3": "$990.75",
        "AI80-3": "$941.86"
    },
    "Arkansas": {
        "BI-1": "$331.18",
        "II-1": "$466.65",
        "AI-1": "$599.62",
        "AI80-1": "$559.62",
        "BI-2": "$397.41",
        "II-2": "$533.31",
        "AI-2": "$666.24",
        "AI80-2": "$621.80",
        "BI-3": "$463.65",
        "II-3": "$599.97",
        "AI-3": "$732.86",
        "AI80-3": "$683.98"
    },
    "Alaska": {
        "BI-1": "$602.82",
        "II-1": "$846.95",
        "AI-1": "$1,088.57",
        "AI80-1": "$1,048.57",
        "BI-2": "$723.38",
        "II-2": "$967.94",
        "AI-2": "$1,209.53",
        "AI80-2": "$1,165.08",
        "BI-3": "$843.95",
        "II-3": "$1,088.93",
        "AI-3": "$1,330.48",
        "AI80-3": "$1,281.59"
    },
    "Montana": {
        "BI-1": "$457.38",
        "II-1": "$643.33",
        "AI-1": "$826.78",
        "AI80-1": "$786.78",
        "BI-2": "$548.85",
        "II-2": "$735.23",
        "AI-2": "$918.64",
        "AI80-2": "$874.20",
        "BI-3": "$640.33",
        "II-3": "$827.13",
        "AI-3": "$1,010.50",
        "AI80-3": "$961.62"
    },
    "Mississippi": {
        "BI-1": "$404.46",
        "II-1": "$569.24",
        "AI-1": "$731.53",
        "AI80-1": "$691.53",
        "BI-2": "$485.35",
        "II-2": "$650.56",
        "AI-2": "$812.81",
        "AI80-2": "$768.36",
        "BI-3": "$566.24",
        "II-3": "$731.88",
        "AI-3": "$894.09",
        "AI80-3": "$845.20"
    },
    "West Virginia": {
        "BI-1": "$445.67",
        "II-1": "$626.94",
        "AI-1": "$805.71",
        "AI80-1": "$765.71",
        "BI-2": "$534.80",
        "II-2": "$716.50",
        "AI-2": "$895.23",
        "AI80-2": "$850.78",
        "BI-3": "$623.94",
        "II-3": "$806.06",
        "AI-3": "$984.75",
        "AI80-3": "$935.86"
    },
    "South Dakota": {
        "BI-1": "$385.38",
        "II-1": "$542.53",
        "AI-1": "$697.18",
        "AI80-1": "$657.18",
        "BI-2": "$462.45",
        "II-2": "$620.03",
        "AI-2": "$774.64",
        "AI80-2": "$730.20",
        "BI-3": "$539.53",
        "II-3": "$697.53",
        "AI-3": "$852.10",
        "AI80-3": "$803.22"
    },
    "Wyoming": {
        "BI-1": "$472.93",
        "II-1": "$665.10",
        "AI-1": "$854.77",
        "AI80-1": "$814.77",
        "BI-2": "$567.52",
        "II-2": "$760.12",
        "AI-2": "$949.75",
        "AI80-2": "$905.31",
        "BI-3": "$662.10",
        "II-3": "$855.13",
        "AI-3": "$1,044.72",
        "AI80-3": "$995.84"
    },
    "North Dakota": {
        "BI-1": "$508.53",
        "II-1": "$714.94",
        "AI-1": "$918.85",
        "AI80-1": "$878.85",
        "BI-2": "$610.24",
        "II-2": "$817.08",
        "AI-2": "$1,020.95",
        "AI80-2": "$976.50",
        "BI-3": "$711.94",
        "II-3": "$919.21",
        "AI-3": "$1,123.04",
        "AI80-3": "$1,074.15"
    }
}

states = {
    "AL": "Alabama",
    "AK": "Alaska",
    "AZ": "Arizona",
    "AR": "Arkansas",
    "CA": "California",
    "CO": "Colorado",
    "CT": "Connecticut",
    "DE": "Delaware",
    "FL": "Florida",
    "GA": "Georgia",
    "HI": "Hawaii",
    "ID": "Idaho",
    "IL": "Illinois",
    "IN": "Indiana",
    "IA": "Iowa",
    "KS": "Kansas",
    "KY": "Kentucky",
    "LA": "Louisiana",
    "ME": "Maine",
    "MD": "Maryland",
    "MA": "Massachusetts",
    "MI": "Michigan",
    "MN": "Minnesota",
    "MS": "Mississippi",
    "MO": "Missouri",
    "MT": "Montana",
    "NE": "Nebraska",
    "NV": "Nevada",
    "NH": "New Hampshire",
    "NJ": "New Jersey",
    "NM": "New Mexico",
    "NY": "New York",
    "NC": "North Carolina",
    "ND": "North Dakota",
    "OH": "Ohio",
    "OK": "Oklahoma",
    "OR": "Oregon",
    "PA": "Pennsylvania",
    "RI": "Rhode Island",
    "SC": "South Carolina",
    "SD": "South Dakota",
    "TN": "Tennessee",
    "TX": "Texas",
    "UT": "Utah",
    "VT": "Vermont",
    "VA": "Virginia",
    "WA": "Washington",
    "WV": "West Virginia",
    "WI": "Wisconsin",
    "WY": "Wyoming",
    "DC": "District of Columbia",
    "AS": "American Samoa",
    "GU": "Guam",
    "MP": "Northern Mariana Islands",
    "PR": "Puerto Rico",
    "UM": "United States Minor Outlying Islands",
    "VI": "U.S. Virgin Islands"
}


def lookup_rate_by_state(abbrev: str, job_tier: str = ALL) -> Union[str, dict]:
    """
    Converts a state abbreviation to the full name and looks up the installer rate
    by job tier for that state.
    
    When no job_tier is provided, it returns the rates for all job tiers in a 
    dictionary.
    """
    state = states[abbrev.upper()]
    if job_tier == ALL:
        return rates[state]
    return rates[state][job_tier]
